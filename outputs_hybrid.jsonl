{"id": "rag_policy_beverages_return_days", "final_answer": 14, "sql": "", "confidence": 0.56, "explanation": "From product policy.", "citations": ["product_policy::chunk0", "marketing_calendar::chunk1", "catalog::chunk0"]}
{"id": "hybrid_top_category_qty_summer_1997", "final_answer": {"category": "Confections", "quantity": 17791}, "sql": "SELECT c.CategoryName AS category,SUM(od.Quantity) AS quantity\nFROM Orders o JOIN \"Order Details\" od ON o.OrderID=od.OrderID\nJOIN Products p ON od.ProductID=p.ProductID JOIN Categories c ON p.CategoryID=c.CategoryID\nWHERE o.OrderDate BETWEEN '2017-06-01' AND '2017-06-30'\nGROUP BY c.CategoryName ORDER BY quantity DESC LIMIT 1", "confidence": 0.78, "explanation": "Top category by quantity.", "citations": ["marketing_calendar::chunk0", "marketing_calendar::chunk1", "kpi_definitions::chunk2", "Orders", "Order Details", "Products", "Categories"]}
{"id": "hybrid_aov_winter_1997", "final_answer": 6990.11, "sql": "SELECT ROUND(SUM(od.UnitPrice*od.Quantity*(1-IFNULL(od.Discount,0)))/COUNT(DISTINCT o.OrderID),2) AS value\nFROM Orders o JOIN \"Order Details\" od ON o.OrderID=od.OrderID\nJOIN Products p ON od.ProductID=p.ProductID JOIN Categories c ON p.CategoryID=c.CategoryID\nWHERE o.OrderDate BETWEEN '2017-12-01' AND '2017-12-31' AND c.CategoryName IN ('Dairy Products','Confections')", "confidence": 0.79, "explanation": "Computed from SQL query.", "citations": ["kpi_definitions::chunk1", "marketing_calendar::chunk2", "kpi_definitions::chunk0", "Orders", "Order Details", "Products", "Categories"]}
{"id": "sql_top3_products_by_revenue_alltime", "final_answer": [{"product": "C\u00f4te de Blaye", "revenue": 53265895.24}, {"product": "Th\u00fcringer Rostbratwurst", "revenue": 24623469.23}, {"product": "Mishi Kobe Niku", "revenue": 19423037.5}], "sql": "SELECT p.ProductName AS product,ROUND(SUM(od.UnitPrice*od.Quantity*(1-IFNULL(od.Discount,0))),2) AS revenue\nFROM \"Order Details\" od JOIN Products p ON od.ProductID=p.ProductID\nGROUP BY p.ProductName ORDER BY revenue DESC LIMIT 3", "confidence": 0.79, "explanation": "Top products by revenue.", "citations": ["kpi_definitions::chunk1", "kpi_definitions::chunk2", "catalog::chunk0", "Order Details", "Products"]}
{"id": "hybrid_revenue_beverages_summer_1997", "final_answer": 591887.18, "sql": "SELECT ROUND(SUM(od.UnitPrice*od.Quantity*(1-IFNULL(od.Discount,0))),2) AS total_revenue\nFROM Orders o JOIN \"Order Details\" od ON o.OrderID=od.OrderID\nJOIN Products p ON od.ProductID=p.ProductID JOIN Categories c ON p.CategoryID=c.CategoryID\nWHERE o.OrderDate BETWEEN '2017-06-01' AND '2017-06-30' AND c.CategoryName='Beverages' ", "confidence": 0.78, "explanation": "Computed from SQL query.", "citations": ["marketing_calendar::chunk1", "marketing_calendar::chunk2", "marketing_calendar::chunk0", "Orders", "Order Details", "Products", "Categories"]}
{"id": "hybrid_best_customer_margin_1997", "final_answer": {"customer": "Wilman Kala", "margin": 251847.49}, "sql": "SELECT cu.CompanyName AS customer,ROUND(SUM((od.UnitPrice*0.3)*od.Quantity*(1-IFNULL(od.Discount,0))),2) AS margin\nFROM Orders o JOIN \"Order Details\" od ON o.OrderID=od.OrderID\nJOIN Customers cu ON o.CustomerID=cu.CustomerID\nWHERE strftime('%Y',o.OrderDate)='2017'\nGROUP BY cu.CustomerID ORDER BY margin DESC LIMIT 1", "confidence": 0.76, "explanation": "Top customer by gross margin.", "citations": ["kpi_definitions::chunk2", "kpi_definitions::chunk0", "marketing_calendar::chunk1", "Orders", "Order Details", "Customers"]}
